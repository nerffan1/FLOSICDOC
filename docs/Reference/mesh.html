
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FLOSIC Mesh &#8212; NRLMOL  2020 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=61eb95e5" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../_static/documentation_options.js?v=939ec2ff"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Reference/mesh';</script>
    <script src="../_static/js/fetch_readme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Useful Scripts and Tools" href="useful_scripts.html" />
    <link rel="prev" title="Basis sets: the ISYMGEN file" href="isymgen.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.1" />
    <meta name="docbuild:last-update" content="Nov 15, 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/log.jpeg" class="logo__image only-light" alt="NRLMOL  2020 documentation - Home"/>
    <img src="../_static/log.jpeg" class="logo__image only-dark pst-js-only" alt="NRLMOL  2020 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="toc.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/tuttoc.html">
    User Guide and Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../dev_guide/docu_guide.html">
    Documentation Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../nrlmolfaq.html">
    FAQs
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://www.flosic.org/">
    FLOSIC Website
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="toc.html">
    Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tutorials/tuttoc.html">
    User Guide and Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../dev_guide/docu_guide.html">
    Documentation Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../nrlmolfaq.html">
    FAQs
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.flosic.org/">
    FLOSIC Website
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Theory.html">Theoretical Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="Generation.html">Generating FODs: FODLego</a></li>
<li class="toctree-l1"><a class="reference internal" href="io_files.html">Input and Output Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputdat.html">NRLMOL_INPUT.DAT: Controlling a calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="functionals.html">Exchange-Correlation functionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="isymgen.html">Basis sets: the ISYMGEN file</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">FLOSIC Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="useful_scripts.html">Useful Scripts and Tools</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="toc.html" class="nav-link">Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">FLOSIC Mesh</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="flosic-mesh">
<span id="mesh"></span><h1>FLOSIC Mesh<a class="headerlink" href="#flosic-mesh" title="Link to this heading">#</a></h1>
<p>In FLOSIC, the mesh is generated by specifying the accuracy of various integrals. The mesh is refined until the specified accuracy of
the integrals is accomplished. In this sense, the mesh is variational. For further details about how the mesh is generated please refer to the paper by Pederson and Jackson(Phys. Rev. B 41, 7453).
There are two types of meshes used in the calculation. One is the radial mesh used for calculations within the
atomic spheres and the other is the interstitial mesh (mesh between atomic spheres). The defaults for these are 1.E-06.
The mesh parameters are stored in the MESHDAT file. The default MESHDAT file for a DFT level calculation will look like the one below.
It is possible to change the default mesh.
The parameters used in creating the mesh are listed in the MESHDAT file. The default MESHDAT file for a DFA calculation is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">F</span>                                                                     <span class="n">line</span> <span class="mi">1</span>
  <span class="mf">0.10000E-06</span>   <span class="mf">1.2000</span>                                                     <span class="n">line</span> <span class="mi">2</span>
   <span class="mi">6</span>                                                                       <span class="n">line</span> <span class="mi">3</span>
  <span class="mf">0.20000</span>      <span class="mf">0.40000</span>      <span class="mf">0.60000</span>       <span class="mf">1.0000</span>       <span class="mf">1.6000</span>              <span class="n">line</span> <span class="mi">4</span>
   <span class="mi">4</span>                                                                       <span class="n">line</span> <span class="mi">5</span>
   <span class="mf">2.1000</span>       <span class="mf">10.100</span>       <span class="mf">18.100</span>                                        <span class="n">line</span> <span class="mi">6</span>
   <span class="mi">2</span>   <span class="mi">1</span>   <span class="mi">3</span>   <span class="mi">5</span>   <span class="mi">5</span>   <span class="mi">7</span>   <span class="mi">9</span>  <span class="mi">11</span>  <span class="mi">19</span>  <span class="mi">21</span>                                   <span class="n">line</span> <span class="mi">7</span>
   <span class="mi">4</span>   <span class="mi">1</span>   <span class="mi">3</span>   <span class="mi">5</span>   <span class="mi">5</span>   <span class="mi">7</span>   <span class="mi">9</span>  <span class="mi">11</span>  <span class="mi">19</span>  <span class="mi">21</span>                                   <span class="n">line</span> <span class="mi">8</span>
   <span class="mi">4</span>   <span class="mi">1</span>   <span class="mi">3</span>   <span class="mi">6</span>   <span class="mi">5</span>   <span class="mi">7</span>   <span class="mi">9</span>  <span class="mi">11</span>  <span class="mi">19</span>  <span class="mi">21</span>                                   <span class="n">line</span> <span class="mi">9</span>
   <span class="mi">6</span>   <span class="mi">1</span>   <span class="mi">3</span>   <span class="mi">6</span>   <span class="mi">7</span>   <span class="mi">7</span>   <span class="mi">9</span>  <span class="mi">11</span>  <span class="mi">19</span>  <span class="mi">21</span>                                   <span class="n">line</span> <span class="mi">10</span>
  <span class="mf">0.10000E-06</span>   <span class="mf">1.2000</span>                                                     <span class="n">line</span> <span class="mi">11</span>
   <span class="mf">2.0000</span>       <span class="mi">8</span>                                                          <span class="n">line</span> <span class="mi">12</span>
   <span class="mf">2.0000</span>                                                                  <span class="n">line</span> <span class="mi">13</span>

</pre></div>
</div>
<p>The default MESHDAT file for a FLOSIC calculations is shown below:</p>
<p>As noted above are two types of meshes used in the calculation. One is the radial mesh use for calculations within atomic spheres and the other is the interstitial mesh.</p>
<p>Line 1:</p>
<p>Line 2: The numbers in this line pertain to the radial mesh. The radial mesh is constructed to give integrations involving various Gaussians from short to long range. The small number is the error allowed in integration by the mesh. The second number, 1.2, separates the exponentials of the Gaussians which are tested i.e. the n+1st exponential is 1.2 times nth exponent. Decreasing the error tolerance will result in increase in number of mesh points and better integrals.</p>
<p>Line 3: The atomic sphere is divided into different concentric regions with different numbers of mesh points. The number of such radial zones is written in line 3.</p>
<p>Line 4: The outer radii of the radial zones.</p>
<p>Line 5: The mesh may be different for different atoms. For example, heavier atoms generally need denser radial meshes
near the nucleus. Hence the periodic table (upto Z=56) is divided in 4 types of meshes.</p>
<p>Line 6: This line shows the 4 types of meshes for atoms : first one for Z&lt;2.1, second one for Z&lt;10.1 and third on for Z&lt;18.1 and the last one for Z&gt;18.</p>
<p>Line 7,8,9,10: These four lines contain the parameters for each type of atomic mesh. The numbers are</p>
<p><strong>NPATS, NPIST, NTHET, NPHI, LMAX</strong> FOR EACH RADIAL ZONE</p>
<p><strong>NPATS</strong> :</p>
<p><strong>NPIST, NTHET, NPHI</strong> : Before creating the mesh, the space is divided into boxes such that each atom is contained in one box. Then a sphere around the atom is assumed and the radial mesh is created. The space at the box corners between the atomic sphere and the rectangular box is divided in a different mesh. The parameters NPIST, NTHET and NPHI correspond to the mesh at the box corners.</p>
<p><strong>LMAX</strong> : LMAX for the each radial zone. This mesh will integrate a function of the type r lmax exp(-. r2) within the given error limit in this region. Increasing LMAX results in a more refined mesh.</p>
<p>Line 11 : This line contains the same parameters as line 2 but for the interstitial mesh. Decreasing the error limit results in more accurate integrals in the interstitial region.</p>
<p>Line 12: Cutfac, mx1d</p>
<p><strong>CUTFAC</strong>: If a box transforms into itself due to symmetry, it will be split if it is larger than cutfac times the distance to the closest atom.</p>
<p><strong>MX1D</strong>: max. number of points in a one-dimensional interstitial partition</p>
<p>Line 13: Splrat</p>
<p><strong>SPLRAT</strong>: largest allowed ratio for: the size of an atomic box divided by the distance of another atom to the box boundary</p>
<blockquote>
<div><p>The user can set these parameters to exercise control over the quality of calculation. For example the default mesh in FLOSIC code has been tested for FLO-SIC-LSDA calculations and is capable of providing accurate results, while the mesh required in a DFT-LDA calculation does not have to have many mesh points as in a FLO-SIC-LDA calculation. Above values are default. <em>Warning</em> When taking energy differences and comparing the energies it is advisable to ensure that same quality of mesh was used in all pertaining calculations.</p>
</div></blockquote>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="isymgen.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Basis sets: the ISYMGEN file</p>
      </div>
    </a>
    <a class="right-next"
       href="useful_scripts.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Useful Scripts and Tools</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/nerffan1/FLOSICDOC/edit/main/Reference/mesh.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/Reference/mesh.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright 2023,   NRLMOL users .
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>